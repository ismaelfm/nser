package defs

import "nser/internal/tool"

func init() {
	r := tool.DefaultRegistry

	r.Register(tool.ToolDef{
		Name:        "sqlmap",
		Category:    tool.CategoryExploit,
		Binary:      "sqlmap",
		DefaultArgs: []string{"--batch"}, // non-interactive mode
		NeedsRoot:   false,
		Description: "Automatic SQL injection detection and exploitation tool",
		InstallHint: map[string]string{
			"linux":   "apt install sqlmap",
			"darwin":  "brew install sqlmap",
			"windows": "pip install sqlmap",
		},
		VersionFlag: "--version",
	})

	r.Register(tool.ToolDef{
		Name:        "hydra",
		Category:    tool.CategoryExploit,
		Binary:      "hydra",
		DefaultArgs: nil,
		NeedsRoot:   false,
		Description: "Fast network login cracker supporting many protocols",
		InstallHint: map[string]string{
			"linux":   "apt install hydra",
			"darwin":  "brew install hydra",
			"windows": "download from https://github.com/vanhauser-thc/thc-hydra",
		},
		VersionFlag: "-h", // hydra prints version in help header
	})
}
